{# app/Resources/views/layout.html.twig #}

<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>{% block title %}Knarf Plateforme{% endblock %}</title>

  {% block stylesheets %}
    <link href="{{ asset('bundles/knarfplatform/css/main.css') }}" type="text/css" rel="stylesheet">
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  {% endblock %}
</head>

<body>
<nav class="navbar navbar-inverse">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>                        
      </button>
      <a class="navbar-brand" href="{{ path('knarf_platform_home') }}">Ma plateforme d'annonces</a>
    </div>
    <div class="collapse navbar-collapse" id="myNavbar">
      <ul class="nav navbar-nav">
        <li class="active"><a href="{{ path('knarf_platform_home') }}">Home</a></li>
        <li class="dropdown">
          <a class="dropdown-toggle" data-toggle="dropdown" href="#">Page 1 <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="#">Page 1-1</a></li>
            <li><a href="#">Page 1-2</a></li>
            <li><a href="#">Page 1-3</a></li>
          </ul>
        </li>
        <li><a href="{{ path('rubrique_home') }}">Rubriques</a></li>
        {% if is_granted('IS_AUTHENTICATED_FULLY') %}              
          <li><a href="{{ path('knarf_platform_add') }}">Ajouter une annonce</a></li>          
          {% endif %}        
      </ul>

      <ul class="nav navbar-nav navbar-right">
        {% if is_granted('IS_AUTHENTICATED_FULLY') %}
       {% if  app.user.nomMedia is not empty %}
    <li class="badge">
        <img src="{{vich_uploader_asset(app.user, 'mediaFile') | imagine_filter('my_thumb') }}" alt="{{ app.user.nomMedia }}"  />
    </li>
    {% endif %}   
        {% if app.request.get('_route')!= 'profile'%}
                    
        <li><a href="{{ path('profile') }}">{{ app.user.username }}</a></li>        
            
        {% endif %}
        
        <li><a href="{{ path('logout') }}"><span class="glyphicon glyphicon-log-out"></span> Déconnexion</a></li>
        
        {% else %}
            
        <li><a href="{{ path('register') }}"><span class="glyphicon glyphicon-user"></span> S'enregistrer</a></li>
        <li><a href="{{ path('login') }}"><span class="glyphicon glyphicon-log-in"></span> Connexion</a></li>
      </ul>
      {% endif %}
    </div>
  </div>
</nav>
  <div class="container">
    <div id="header" class="jumbotron">
      <h1></h1>
      <p>
        Ce projet est propulsé par Symfony
      </p>
      <p>
        <a class="btn btn-primary btn-lg" href="http://test_project.dev">
          Aller voir un autre projet »
        </a>
      </p>
    </div>      


    <div class="row">
      <div id="menu" class="col-md-3">      
        
        {% if is_granted('IS_AUTHENTICATED_FULLY') %}
            {% if app.user.adverts %}
                <h3>Mes annonces</h3>
            <ul class="nav nav-pills nav-stacked">  
                    {% for entity in app.user.adverts %}
                        <li>
                        <a href="{{ path('knarf_platform_view', { 'id': entity.id }) }}">
                            {{ entity.title }}</a>
                        </li>    
                    {% endfor %}
            {% endif %}
        {% endif %}
        </ul>
        <h4>Dernières annonces</h4>
        {{ render(controller("KnarfPlatformBundle:Advert:menu", {'limit': 3})) }}
      </div>
      <div id="content" class="col-md-9">
          
        {% set flashbag_notices = app.session.flashbag.get('notice') %}
	{% if flashbag_notices is not empty %}
            <div class="msg" onClick="cacher();">
		{% for notice in flashbag_notices %}
                    {{ notice }}
		{% endfor %}
            </div>
	{% endif %}
        
        {% block body %}

        {% endblock %}
      </div>
    </div>

    <hr>

    <footer>
      <p>The sky's the limit © {{ 'now'|date('Y') }} and beyond.</p>
    </footer>
  </div>

  {% block javascripts %}
    {# Ajoutez ces lignes JavaScript si vous comptez vous servir des fonctionnalités du bootstrap Twitter #}
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
    <script>
                $(document).ready(function(){
                $(document.getElementsByClassName("msg")).click(function(){
                $(this).hide();
                });
                });
    </script>
    <script>
                $(document).ready(function(){
                $(document.getElementById("commentaire")).click(function(){
                $(this).hide();
                });
                });
    </script>
  {% endblock %}

</body>
</html>
